<!----------------------------------------------------------------------------- 
Login.html - Liberalia

- Plantilla para la página de inicio de sesión.
- Extiende de base.html para mantener la estructura y estilos comunes.
- Contiene formulario con email y contraseña, validaciones de Bootstrap 5, y mensajes de feedback.
- Incluye funcionalidad para mostrar/ocultar la contraseña con el icono de ojo.
- Permite acceso al enlace de recuperación de contraseña.
---------------------------------------------------------------------------->


{% extends "base.html" %}
{% load static %}
{% block title %}Iniciar sesión - Liberalia{% endblock %}

{% block content %}
<div class="card shadow-sm auth-card p-3 p-md-4">
  <div class="text-center mb-3">
    <img src="{% static 'img/logo_liberalia.jpg' %}" class="brand-logo" alt="Liberalia">
  </div>

  <h5 class="text-center mb-3">Inicio de Sesión</h5>

  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} mb-3" role="alert">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}

  <form method="post" class="needs-validation" novalidate>
    {% csrf_token %}

    <!-- Email -->
    <div class="mb-3">   
      <input type="email" name="email" id="id_email" class="form-control" placeholder="Correo Test"
             required autocomplete="email" value="{{ form.email.value|default:'' }}">
      <div class="invalid-feedback">Ingresa un correo válido</div>
    </div>

    <!-- Password con ojo dentro -->
    <div class="mb-2 position-relative">
      <input type="password" name="password" id="id_password" class="form-control pe-5" placeholder="Contraseña"
             required minlength="6" autocomplete="current-password">
      <i class="bi bi-eye password-toggle position-absolute top-50 end-0 translate-middle-y me-3"
         id="togglePassword" style="cursor: pointer;"></i>
      <div class="invalid-feedback">Debe ingresar password</div>
    </div>

    <!-- Link reset -->
    <div class="text-end mb-3">
      <a href="{% url 'password_reset' %}" class="link-secondary small">¿Has olvidado tu contraseña?</a>
    </div>

    <!-- Botón submit -->
    <div class="d-grid">
      <button type="submit" class="btn btn-dark rounded-4 py-2">Iniciar sesión Test</button>
    </div>
  </form>
</div>

<!-- Script para alternar password con mouse -->
<script>
  const passwordField = document.getElementById("id_password");
  const toggleIcon = document.getElementById("togglePassword");

  toggleIcon.addEventListener("mousedown", function() {
    passwordField.type = "text";
    toggleIcon.classList.remove("bi-eye");
    toggleIcon.classList.add("bi-eye-slash");
  });

  toggleIcon.addEventListener("mouseup", function() {
    passwordField.type = "password";
    toggleIcon.classList.remove("bi-eye-slash");
    toggleIcon.classList.add("bi-eye");
  });

  toggleIcon.addEventListener("mouseleave", function() {
    passwordField.type = "password";
    toggleIcon.classList.remove("bi-eye-slash");
    toggleIcon.classList.add("bi-eye");
  });
</script>
{% endblock %}
